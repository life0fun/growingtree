// Compiled by ClojureScript 0.0-2277
goog.provide('growingtree_app.controllers.states');
goog.require('cljs.core');
goog.require('growingtree_app.utils');
goog.require('cljs.core.async');
goog.require('growingtree_app.utils');
goog.require('growingtree_app.utils');
goog.require('growingtree_app.mock_data');
goog.require('growingtree_app.mock_data');
goog.require('cljs.reader');
goog.require('cljs.reader');
goog.require('cljs.core.async');
goog.require('cljs.core.async');
cljs.core.enable_console_print_BANG_.call(null);
growingtree_app.controllers.states.transition = (function (){var method_table__4409__auto__ = cljs.core.atom.call(null,cljs.core.PersistentArrayMap.EMPTY);var prefer_table__4410__auto__ = cljs.core.atom.call(null,cljs.core.PersistentArrayMap.EMPTY);var method_cache__4411__auto__ = cljs.core.atom.call(null,cljs.core.PersistentArrayMap.EMPTY);var cached_hierarchy__4412__auto__ = cljs.core.atom.call(null,cljs.core.PersistentArrayMap.EMPTY);var hierarchy__4413__auto__ = cljs.core.get.call(null,cljs.core.PersistentArrayMap.EMPTY,new cljs.core.Keyword(null,"hierarchy","hierarchy",-1053470341),cljs.core.get_global_hierarchy.call(null));return (new cljs.core.MultiFn("transition",((function (method_table__4409__auto__,prefer_table__4410__auto__,method_cache__4411__auto__,cached_hierarchy__4412__auto__,hierarchy__4413__auto__){
return (function (target,msg_type,msg_data,state){return msg_type;
});})(method_table__4409__auto__,prefer_table__4410__auto__,method_cache__4411__auto__,cached_hierarchy__4412__auto__,hierarchy__4413__auto__))
,new cljs.core.Keyword(null,"default","default",-1987822328),hierarchy__4413__auto__,method_table__4409__auto__,prefer_table__4410__auto__,method_cache__4411__auto__,cached_hierarchy__4412__auto__));
})();
cljs.core._add_method.call(null,growingtree_app.controllers.states.transition,new cljs.core.Keyword(null,"default","default",-1987822328),(function (target,msg_type,msg_data,state){console.log(cljs.core.pr_str.call(null,"default transition : conj nav-path ",msg_type,msg_data));
return cljs.core.update_in.call(null,state,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"nav-path","nav-path",-444531376)], null),cljs.core.conj,msg_data);
}));
cljs.core._add_method.call(null,growingtree_app.controllers.states.transition,new cljs.core.Keyword(null,"login","login",55217519),(function (target,msg_type,msg_data,state){var cur_nav_type = cljs.core.get_in.call(null,msg_data,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"body","body",-2049205669),(1),(2)], null));console.log(cljs.core.pr_str.call(null,"control event :login conj nav-path ",msg_data));
var G__11741 = state;var G__11741__$1 = ((new cljs.core.Keyword(null,"else","else",-1508377146))?cljs.core.update_in.call(null,G__11741,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"nav-path","nav-path",-444531376)], null),cljs.core.conj,msg_data):G__11741);return G__11741__$1;
}));
cljs.core._add_method.call(null,growingtree_app.controllers.states.transition,new cljs.core.Keyword(null,"all-things","all-things",1825895767),(function (target,msg_type,msg_data,state){var last_nav_type = cljs.core.get_in.call(null,cljs.core.last.call(null,cljs.core.get_in.call(null,state,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"nav-path","nav-path",-444531376)], null))),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"body","body",-2049205669),(1),(2)], null));var cur_nav_type = cljs.core.get_in.call(null,msg_data,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"body","body",-2049205669),(1),(2)], null));console.log(cljs.core.pr_str.call(null,"control event :all-things : conj nav-path ",msg_data));
var G__11742 = state;var G__11742__$1 = ((new cljs.core.Keyword(null,"else","else",-1508377146))?growingtree_app.controllers.states.update_navbar_selected.call(null,G__11742,last_nav_type,cur_nav_type):G__11742);var G__11742__$2 = ((new cljs.core.Keyword(null,"else","else",-1508377146))?cljs.core.update_in.call(null,G__11742__$1,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"nav-path","nav-path",-444531376)], null),cljs.core.conj,msg_data):G__11742__$1);return G__11742__$2;
}));
cljs.core._add_method.call(null,growingtree_app.controllers.states.transition,new cljs.core.Keyword(null,"filter-things","filter-things",-1018039660),(function (target,msg_type,msg_data,state){var last_nav_type = cljs.core.get_in.call(null,cljs.core.last.call(null,cljs.core.get_in.call(null,state,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"nav-path","nav-path",-444531376)], null))),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"body","body",-2049205669),(1),(2)], null));var cur_nav_type = cljs.core.get_in.call(null,msg_data,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"body","body",-2049205669),(1),(2)], null));console.log(cljs.core.pr_str.call(null,"control event :filter-things conj nav-path ",msg_data));
var G__11743 = state;var G__11743__$1 = ((new cljs.core.Keyword(null,"else","else",-1508377146))?growingtree_app.controllers.states.update_navbar_selected.call(null,G__11743,last_nav_type,cur_nav_type):G__11743);var G__11743__$2 = ((new cljs.core.Keyword(null,"else","else",-1508377146))?cljs.core.update_in.call(null,G__11743__$1,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"nav-path","nav-path",-444531376)], null),cljs.core.conj,msg_data):G__11743__$1);return G__11743__$2;
}));
cljs.core._add_method.call(null,growingtree_app.controllers.states.transition,new cljs.core.Keyword(null,"add-thing","add-thing",321362583),(function (target,msg_type,msg_data,state){console.log(cljs.core.pr_str.call(null,"control event :add-thing : conj nav-path ",msg_data));
return cljs.core.update_in.call(null,state,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"nav-path","nav-path",-444531376)], null),cljs.core.conj,msg_data);
}));
cljs.core._add_method.call(null,growingtree_app.controllers.states.transition,new cljs.core.Keyword(null,"search-things","search-things",150817957),(function (target,msg_type,msg_data,state){console.log(cljs.core.pr_str.call(null,"control event :search-thing : conj nav-path ",msg_data));
return cljs.core.update_in.call(null,state,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"nav-path","nav-path",-444531376)], null),cljs.core.conj,msg_data);
}));
cljs.core._add_method.call(null,growingtree_app.controllers.states.transition,new cljs.core.Keyword(null,"api-data","api-data",103234986),(function (target,msg_type,msg_data,state){var comm = cljs.core.get_in.call(null,state,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"comms","comms",460172477),new cljs.core.Keyword(null,"controls","controls",1340701452)], null));var things_vec = new cljs.core.Keyword(null,"things-vec","things-vec",-1363222375).cljs$core$IFn$_invoke$arity$1(msg_data);var nav_path = new cljs.core.Keyword(null,"nav-path","nav-path",-444531376).cljs$core$IFn$_invoke$arity$1(msg_data);var thing_type = cljs.core.get_in.call(null,nav_path,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"body","body",-2049205669),(1),(2)], null));console.log(cljs.core.pr_str.call(null,"api-data set :body things-vec ",nav_path,thing_type,msg_data));
if(cljs.core._EQ_.call(null,new cljs.core.Keyword(null,"login","login",55217519),thing_type))
{return growingtree_app.controllers.states.login_state_transition.call(null,target,thing_type,msg_data,state);
} else
{return cljs.core.assoc_in.call(null,state,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"body","body",-2049205669)], null),things_vec);
}
}));
growingtree_app.controllers.states.login_state_transition = (function login_state_transition(target,thing_type,msg_data,state){var comm = cljs.core.get_in.call(null,state,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"comms","comms",460172477),new cljs.core.Keyword(null,"controls","controls",1340701452)], null));var things_vec = new cljs.core.Keyword(null,"things-vec","things-vec",-1363222375).cljs$core$IFn$_invoke$arity$1(msg_data);var nav_path = new cljs.core.Keyword(null,"nav-path","nav-path",-444531376).cljs$core$IFn$_invoke$arity$1(msg_data);var last_nav_path = cljs.core.last.call(null,cljs.core.get_in.call(null,state,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"nav-path","nav-path",-444531376)], null)));var login_user = cljs.core.get_in.call(null,state,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"login-user","login-user",1935565562)], null));var msg = new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"logged-in","logged-in",627058423),new cljs.core.Keyword(null,"login-user","login-user",1935565562)], null);console.log(cljs.core.pr_str.call(null,"login-state-transition last nav-path ",last_nav_path));
cljs.core.async.put_BANG_.call(null,comm,msg);
return cljs.core.update_in.call(null,cljs.core.assoc_in.call(null,state,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"login-user","login-user",1935565562)], null),cljs.core.into.call(null,cljs.core.PersistentArrayMap.EMPTY,things_vec)),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"nav-path","nav-path",-444531376)], null),cljs.core.conj,new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"title","title",636505583),cljs.core.PersistentVector.EMPTY,new cljs.core.Keyword(null,"body","body",-2049205669),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"all","all",892129742),(0),new cljs.core.Keyword(null,"course","course",1455432948)], null),new cljs.core.Keyword(null,"data","data",-232669377),cljs.core.PersistentArrayMap.EMPTY], null));
});
cljs.core._add_method.call(null,growingtree_app.controllers.states.transition,new cljs.core.Keyword(null,"api-success","api-success",1221200738),(function (target,msg_type,msg_data,state){var comm = cljs.core.get_in.call(null,state,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"comms","comms",460172477),new cljs.core.Keyword(null,"controls","controls",1340701452)], null));var last_nav_path = cljs.core.last.call(null,cljs.core.drop_last.call(null,cljs.core.get_in.call(null,state,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"nav-path","nav-path",-444531376)], null))));var msg = (function (){var msg_type__$1 = cljs.core.get_in.call(null,last_nav_path,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"body","body",-2049205669),(0)], null));var msg_type__$2 = ((cljs.core._EQ_.call(null,new cljs.core.Keyword(null,"newthing-form","newthing-form",-676457503),msg_type__$1))?growingtree_app.mock_data.get_all_things_msg.call(null,cljs.core.get_in.call(null,last_nav_path,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"body","body",-2049205669),(1),(0)], null)),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"author","author",2111686192),"rich-dad"], null)):new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [msg_type__$1,last_nav_path], null));return msg_type__$2;
})();console.log(cljs.core.pr_str.call(null,"api-success : re-direct by sending to comm msg ",msg));
cljs.core.async.put_BANG_.call(null,comm,msg);
return cljs.core.assoc_in.call(null,state,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"body","body",-2049205669)], null),null);
}));
cljs.core._add_method.call(null,growingtree_app.controllers.states.transition,new cljs.core.Keyword(null,"api-error","api-error",1506636439),(function (target,msg_type,msg_data,state){console.log(cljs.core.pr_str.call(null,"api-error ",msg_type,msg_data));
var comm = cljs.core.get_in.call(null,state,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"comms","comms",460172477),new cljs.core.Keyword(null,"controls","controls",1340701452)], null));var nav_path = cljs.core.last.call(null,cljs.core.get_in.call(null,state,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"nav-path","nav-path",-444531376)], null)));var thing_type = cljs.core.get_in.call(null,nav_path,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"body","body",-2049205669),(0)], null));var error = new cljs.core.Keyword(null,"error","error",-978969032).cljs$core$IFn$_invoke$arity$1(msg_data);var error_msg = cljs.core.get_in.call(null,msg_data,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"error","error",-978969032),new cljs.core.Keyword(null,"status-text","status-text",-1834235478)], null));var nav_path__$1 = new cljs.core.Keyword(null,"nav-path","nav-path",-444531376).cljs$core$IFn$_invoke$arity$1(msg_data);console.log(cljs.core.pr_str.call(null,"api-error [:error] ",nav_path__$1,error_msg,msg_data));
return cljs.core.assoc_in.call(null,state,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"error","error",-978969032)], null),msg_data);
}));
cljs.core._add_method.call(null,growingtree_app.controllers.states.transition,new cljs.core.Keyword(null,"api-key-updated","api-key-updated",-1848658586),(function (target,msg_type,api_key,state){return cljs.core.assoc_in.call(null,state,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"users","users",-713552705),new cljs.core.Keyword(null,"current-user-email","current-user-email",-1030852599).cljs$core$IFn$_invoke$arity$1(state),new cljs.core.Keyword(null,"api-key","api-key",1037904031)], null),api_key);
}));
cljs.core._add_method.call(null,growingtree_app.controllers.states.transition,new cljs.core.Keyword(null,"current-user-mentioned","current-user-mentioned",134481480),(function (target,msg_type,p__11744,state){var vec__11745 = p__11744;var activity = cljs.core.nth.call(null,vec__11745,(0),null);var url = cljs.core.nth.call(null,vec__11745,(1),null);return cljs.core.assoc_in.call(null,state,new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"channels","channels",1132759174),new cljs.core.Keyword(null,"channel-id","channel-id",138191095).cljs$core$IFn$_invoke$arity$1(activity),new cljs.core.Keyword(null,"sfx","sfx",-634589668),new cljs.core.Keyword(null,"source-url","source-url",569467631)], null),url);
}));
cljs.core._add_method.call(null,growingtree_app.controllers.states.transition,new cljs.core.Keyword(null,"user-menu-toggled","user-menu-toggled",-1800346032),(function (target,msg_type,msg_data,state){return cljs.core.update_in.call(null,state,new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"settings","settings",1556144875),new cljs.core.Keyword(null,"menus","menus",-1377611675),new cljs.core.Keyword(null,"user-menu","user-menu",-395327477),new cljs.core.Keyword(null,"open","open",-1763596448)], null),cljs.core.not);
}));
cljs.core._add_method.call(null,growingtree_app.controllers.states.transition,new cljs.core.Keyword(null,"search-form-focused","search-form-focused",-1652397576),(function (target,msg_type,msg_data,state){return cljs.core.assoc_in.call(null,state,new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"settings","settings",1556144875),new cljs.core.Keyword(null,"forms","forms",2045992350),new cljs.core.Keyword(null,"search","search",1564939822),new cljs.core.Keyword(null,"focused","focused",1851572115)], null),true);
}));
cljs.core._add_method.call(null,growingtree_app.controllers.states.transition,new cljs.core.Keyword(null,"search-form-blurred","search-form-blurred",1104978531),(function (target,msg_type,msg_data,state){return cljs.core.assoc_in.call(null,state,new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"settings","settings",1556144875),new cljs.core.Keyword(null,"forms","forms",2045992350),new cljs.core.Keyword(null,"search","search",1564939822),new cljs.core.Keyword(null,"focused","focused",1851572115)], null),false);
}));
cljs.core._add_method.call(null,growingtree_app.controllers.states.transition,new cljs.core.Keyword(null,"search-form-updated","search-form-updated",-868859534),(function (target,msg_type,new_value,state){return cljs.core.assoc_in.call(null,state,new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"settings","settings",1556144875),new cljs.core.Keyword(null,"forms","forms",2045992350),new cljs.core.Keyword(null,"search","search",1564939822),new cljs.core.Keyword(null,"value","value",305978217)], null),new_value);
}));
cljs.core._add_method.call(null,growingtree_app.controllers.states.transition,new cljs.core.Keyword(null,"user-msg-type-focused","user-msg-type-focused",897271494),(function (target,msg_type,msg_data,state){return cljs.core.assoc_in.call(null,state,new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"settings","settings",1556144875),new cljs.core.Keyword(null,"forms","forms",2045992350),new cljs.core.Keyword(null,"user-msg-type","user-msg-type",1884615318),new cljs.core.Keyword(null,"focused","focused",1851572115)], null),true);
}));
cljs.core._add_method.call(null,growingtree_app.controllers.states.transition,new cljs.core.Keyword(null,"user-msg-type-blurred","user-msg-type-blurred",-53788449),(function (target,msg_type,msg_data,state){return cljs.core.assoc_in.call(null,state,new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"settings","settings",1556144875),new cljs.core.Keyword(null,"forms","forms",2045992350),new cljs.core.Keyword(null,"user-msg-type","user-msg-type",1884615318),new cljs.core.Keyword(null,"focused","focused",1851572115)], null),false);
}));
cljs.core._add_method.call(null,growingtree_app.controllers.states.transition,new cljs.core.Keyword(null,"user-msg-type-updated","user-msg-type-updated",-127984657),(function (target,msg_type,msg_data,state){return cljs.core.assoc_in.call(null,state,new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"settings","settings",1556144875),new cljs.core.Keyword(null,"forms","forms",2045992350),new cljs.core.Keyword(null,"user-msg-type","user-msg-type",1884615318),new cljs.core.Keyword(null,"value","value",305978217)], null),msg_data);
}));
cljs.core._add_method.call(null,growingtree_app.controllers.states.transition,new cljs.core.Keyword(null,"audio-player-started","audio-player-started",-1739082677),(function (target,msg_type,channel_id,state){return cljs.core.assoc_in.call(null,state,new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"channels","channels",1132759174),channel_id,new cljs.core.Keyword(null,"player","player",-97687400),new cljs.core.Keyword(null,"state","state",-1988618099)], null),new cljs.core.Keyword(null,"playing","playing",70013335));
}));
cljs.core._add_method.call(null,growingtree_app.controllers.states.transition,new cljs.core.Keyword(null,"audio-player-stopped","audio-player-stopped",170014150),(function (target,msg_type,channel_id,state){return cljs.core.assoc_in.call(null,state,new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"channels","channels",1132759174),channel_id,new cljs.core.Keyword(null,"player","player",-97687400),new cljs.core.Keyword(null,"state","state",-1988618099)], null),new cljs.core.Keyword(null,"stopped","stopped",-1490414640));
}));
cljs.core._add_method.call(null,growingtree_app.controllers.states.transition,new cljs.core.Keyword(null,"audio-player-muted","audio-player-muted",-131538835),(function (target,msg_type,msg_data,state){return cljs.core.assoc_in.call(null,state,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"audio","audio",1819127321),new cljs.core.Keyword(null,"muted","muted",1275109029)], null),true);
}));
cljs.core._add_method.call(null,growingtree_app.controllers.states.transition,new cljs.core.Keyword(null,"audio-player-unmuted","audio-player-unmuted",710141160),(function (target,msg_type,msg_data,state){return cljs.core.assoc_in.call(null,state,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"audio","audio",1819127321),new cljs.core.Keyword(null,"muted","muted",1275109029)], null),false);
}));
cljs.core._add_method.call(null,growingtree_app.controllers.states.transition,new cljs.core.Keyword(null,"audio-player-unmuted","audio-player-unmuted",710141160),(function (target,msg_type,msg_data,state){return cljs.core.assoc_in.call(null,state,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"audio","audio",1819127321),new cljs.core.Keyword(null,"muted","muted",1275109029)], null),false);
}));
cljs.core._add_method.call(null,growingtree_app.controllers.states.transition,new cljs.core.Keyword(null,"audio-player-source-updated","audio-player-source-updated",-983718025),(function (target,msg_type,p__11746,state){var vec__11747 = p__11746;var src = cljs.core.nth.call(null,vec__11747,(0),null);var channel_id = cljs.core.nth.call(null,vec__11747,(1),null);return cljs.core.assoc_in.call(null,state,new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"channels","channels",1132759174),channel_id,new cljs.core.Keyword(null,"player","player",-97687400),new cljs.core.Keyword(null,"source-url","source-url",569467631)], null),src);
}));
cljs.core._add_method.call(null,growingtree_app.controllers.states.transition,new cljs.core.Keyword(null,"audio-player-unmuted","audio-player-unmuted",710141160),(function (target,msg_type,msg_data,state){return cljs.core.assoc_in.call(null,state,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"audio","audio",1819127321),new cljs.core.Keyword(null,"muted","muted",1275109029)], null),false);
}));
cljs.core._add_method.call(null,growingtree_app.controllers.states.transition,new cljs.core.Keyword(null,"playlist-entry-queued","playlist-entry-queued",-1071587042),(function (target,msg_type,msg_data,state){var vec__11748 = msg_data;var channel_id = cljs.core.nth.call(null,vec__11748,(0),null);var url = cljs.core.nth.call(null,vec__11748,(1),null);return cljs.core.update_in.call(null,state,new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"channels","channels",1132759174),channel_id,new cljs.core.Keyword(null,"player","player",-97687400),new cljs.core.Keyword(null,"playlist","playlist",1952276871)], null),((function (vec__11748,channel_id,url){
return (function (playlist){return cljs.core.conj.call(null,playlist,new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"order","order",-1254677256),(cljs.core.count.call(null,playlist) + (1)),new cljs.core.Keyword(null,"src","src",-1651076051),url], null));
});})(vec__11748,channel_id,url))
);
}));
cljs.core._add_method.call(null,growingtree_app.controllers.states.transition,new cljs.core.Keyword(null,"playlist-entry-played","playlist-entry-played",1138783655),(function (target,msg_type,p__11749,state){var vec__11750 = p__11749;var order = cljs.core.nth.call(null,vec__11750,(0),null);var channel_id = cljs.core.nth.call(null,vec__11750,(1),null);return cljs.core.assoc_in.call(null,cljs.core.assoc_in.call(null,state,new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"channels","channels",1132759174),channel_id,new cljs.core.Keyword(null,"player","player",-97687400),new cljs.core.Keyword(null,"playing-order","playing-order",-1040974713)], null),order),new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"channels","channels",1132759174),channel_id,new cljs.core.Keyword(null,"player","player",-97687400),new cljs.core.Keyword(null,"loading","loading",-737050189)], null),true);
}));
cljs.core._add_method.call(null,growingtree_app.controllers.states.transition,new cljs.core.Keyword(null,"user-msg-type-submitted","user-msg-type-submitted",1017951497),(function (target,msg_type,msg_data,state){if(cljs.core.empty_QMARK_.call(null,cljs.core.get_in.call(null,state,new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"settings","settings",1556144875),new cljs.core.Keyword(null,"forms","forms",2045992350),new cljs.core.Keyword(null,"user-msg-type","user-msg-type",1884615318),new cljs.core.Keyword(null,"value","value",305978217)], null))))
{return state;
} else
{var content = cljs.core.get_in.call(null,state,new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"settings","settings",1556144875),new cljs.core.Keyword(null,"forms","forms",2045992350),new cljs.core.Keyword(null,"user-msg-type","user-msg-type",1884615318),new cljs.core.Keyword(null,"value","value",305978217)], null));var user = cljs.core.get_in.call(null,state,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"users","users",-713552705),new cljs.core.Keyword(null,"current-user-email","current-user-email",-1030852599).cljs$core$IFn$_invoke$arity$1(state)], null));var channel = cljs.core.get_in.call(null,state,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"channels","channels",1132759174),new cljs.core.Keyword(null,"selected-channel","selected-channel",-366010130).cljs$core$IFn$_invoke$arity$1(state)], null));var activity = new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"content","content",15833224),content,new cljs.core.Keyword(null,"author","author",2111686192),new cljs.core.Keyword(null,"email","email",1415816706).cljs$core$IFn$_invoke$arity$1(user),new cljs.core.Keyword(null,"created_at","created_at",1484050750),(new Date())], null);return cljs.core.update_in.call(null,cljs.core.update_in.call(null,cljs.core.assoc_in.call(null,state,new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"settings","settings",1556144875),new cljs.core.Keyword(null,"forms","forms",2045992350),new cljs.core.Keyword(null,"user-msg-type","user-msg-type",1884615318),new cljs.core.Keyword(null,"value","value",305978217)], null),null),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"channels","channels",1132759174),new cljs.core.Keyword(null,"id","id",-1388402092).cljs$core$IFn$_invoke$arity$1(channel),new cljs.core.Keyword(null,"activities","activities",1654844313)], null),cljs.core.comp.call(null,cljs.core.partial.call(null,cljs.core.sort_by,new cljs.core.Keyword(null,"created_at","created_at",1484050750)),cljs.core.conj),activity),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"channels","channels",1132759174),new cljs.core.Keyword(null,"id","id",-1388402092).cljs$core$IFn$_invoke$arity$1(channel),new cljs.core.Keyword(null,"activities","activities",1654844313)], null),cljs.core.vec);
}
}));
cljs.core._add_method.call(null,growingtree_app.controllers.states.transition,new cljs.core.Keyword(null,"settings-opened","settings-opened",1153146657),(function (target,msg_type,msg_data,state){return cljs.core.assoc_in.call(null,state,new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"settings","settings",1556144875),new cljs.core.Keyword(null,"menus","menus",-1377611675),new cljs.core.Keyword(null,"user-menu","user-menu",-395327477),new cljs.core.Keyword(null,"open","open",-1763596448)], null),false);
}));
cljs.core._add_method.call(null,growingtree_app.controllers.states.transition,new cljs.core.Keyword(null,"help-opened","help-opened",-1936034706),(function (target,msg_type,msg_data,state){return cljs.core.assoc_in.call(null,state,new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"settings","settings",1556144875),new cljs.core.Keyword(null,"menus","menus",-1377611675),new cljs.core.Keyword(null,"user-menu","user-menu",-395327477),new cljs.core.Keyword(null,"open","open",-1763596448)], null),false);
}));
cljs.core._add_method.call(null,growingtree_app.controllers.states.transition,new cljs.core.Keyword(null,"about-opened","about-opened",1534685245),(function (target,msg_type,msg_data,state){return cljs.core.assoc_in.call(null,state,new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"settings","settings",1556144875),new cljs.core.Keyword(null,"menus","menus",-1377611675),new cljs.core.Keyword(null,"user-menu","user-menu",-395327477),new cljs.core.Keyword(null,"open","open",-1763596448)], null),false);
}));
cljs.core._add_method.call(null,growingtree_app.controllers.states.transition,new cljs.core.Keyword(null,"user-logged-out","user-logged-out",-1569726039),(function (target,msg_type,msg_data,state){return cljs.core.assoc_in.call(null,cljs.core.assoc_in.call(null,state,new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"settings","settings",1556144875),new cljs.core.Keyword(null,"menus","menus",-1377611675),new cljs.core.Keyword(null,"user-menu","user-menu",-395327477),new cljs.core.Keyword(null,"open","open",-1763596448)], null),false),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"current-user-email","current-user-email",-1030852599)], null),null);
}));
cljs.core._add_method.call(null,growingtree_app.controllers.states.transition,new cljs.core.Keyword(null,"audio-source-loaded","audio-source-loaded",-84261367),(function (target,msg_type,channel_id,state){return cljs.core.assoc_in.call(null,state,new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"channels","channels",1132759174),channel_id,new cljs.core.Keyword(null,"player","player",-97687400),new cljs.core.Keyword(null,"loading","loading",-737050189)], null),false);
}));
cljs.core._add_method.call(null,growingtree_app.controllers.states.transition,new cljs.core.Keyword(null,"channel-destroyed","channel-destroyed",-199507832),(function (target,msg_type,channel_id,state){return cljs.core.assoc_in.call(null,state,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"channels","channels",1132759174),channel_id,new cljs.core.Keyword(null,"loading","loading",-737050189)], null),true);
}));
cljs.core._add_method.call(null,growingtree_app.controllers.states.transition,new cljs.core.Keyword(null,"right-sidebar-toggled","right-sidebar-toggled",925883782),(function (target,msg_type,channel_id,state){return cljs.core.update_in.call(null,state,new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"settings","settings",1556144875),new cljs.core.Keyword(null,"sidebar","sidebar",35784458),new cljs.core.Keyword(null,"right","right",-452581833),new cljs.core.Keyword(null,"open","open",-1763596448)], null),cljs.core.not);
}));
cljs.core._add_method.call(null,growingtree_app.controllers.states.transition,new cljs.core.Keyword(null,"left-sidebar-toggled","left-sidebar-toggled",888056217),(function (target,msg_type,channel_id,state){return cljs.core.update_in.call(null,state,new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"settings","settings",1556144875),new cljs.core.Keyword(null,"sidebar","sidebar",35784458),new cljs.core.Keyword(null,"left","left",-399115937),new cljs.core.Keyword(null,"open","open",-1763596448)], null),cljs.core.not);
}));
growingtree_app.controllers.states.window_drag_event = (function (){var method_table__4409__auto__ = cljs.core.atom.call(null,cljs.core.PersistentArrayMap.EMPTY);var prefer_table__4410__auto__ = cljs.core.atom.call(null,cljs.core.PersistentArrayMap.EMPTY);var method_cache__4411__auto__ = cljs.core.atom.call(null,cljs.core.PersistentArrayMap.EMPTY);var cached_hierarchy__4412__auto__ = cljs.core.atom.call(null,cljs.core.PersistentArrayMap.EMPTY);var hierarchy__4413__auto__ = cljs.core.get.call(null,cljs.core.PersistentArrayMap.EMPTY,new cljs.core.Keyword(null,"hierarchy","hierarchy",-1053470341),cljs.core.get_global_hierarchy.call(null));return (new cljs.core.MultiFn("window-drag-event",((function (method_table__4409__auto__,prefer_table__4410__auto__,method_cache__4411__auto__,cached_hierarchy__4412__auto__,hierarchy__4413__auto__){
return (function (msg_type,msg_data,state){return msg_type;
});})(method_table__4409__auto__,prefer_table__4410__auto__,method_cache__4411__auto__,cached_hierarchy__4412__auto__,hierarchy__4413__auto__))
,new cljs.core.Keyword(null,"default","default",-1987822328),hierarchy__4413__auto__,method_table__4409__auto__,prefer_table__4410__auto__,method_cache__4411__auto__,cached_hierarchy__4412__auto__));
})();
cljs.core._add_method.call(null,growingtree_app.controllers.states.window_drag_event,new cljs.core.Keyword(null,"grabbed","grabbed",-1247636222),(function (msg_type,initial_mouse_pos,window_state){var vec__11751 = initial_mouse_pos;var mx = cljs.core.nth.call(null,vec__11751,(0),null);var my = cljs.core.nth.call(null,vec__11751,(1),null);var vec__11752 = new cljs.core.Keyword(null,"position","position",-2011731912).cljs$core$IFn$_invoke$arity$1(window_state);var px = cljs.core.nth.call(null,vec__11752,(0),null);var py = cljs.core.nth.call(null,vec__11752,(1),null);var offset = new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(mx - px),(my - py)], null);return cljs.core.assoc.call(null,window_state,new cljs.core.Keyword(null,"dragging?","dragging?",-995941410),true,new cljs.core.Keyword(null,"offset","offset",296498311),offset);
}));
cljs.core._add_method.call(null,growingtree_app.controllers.states.window_drag_event,new cljs.core.Keyword(null,"released","released",381037203),(function (msg_type,data,window_state){return cljs.core.assoc.call(null,window_state,new cljs.core.Keyword(null,"dragging?","dragging?",-995941410),false);
}));
cljs.core._add_method.call(null,growingtree_app.controllers.states.window_drag_event,new cljs.core.Keyword(null,"mouse-moved","mouse-moved",-1918152310),(function (msg_type,mouse_position,window_state){if(cljs.core.truth_(new cljs.core.Keyword(null,"dragging?","dragging?",-995941410).cljs$core$IFn$_invoke$arity$1(window_state)))
{var vec__11753 = mouse_position;var mx = cljs.core.nth.call(null,vec__11753,(0),null);var my = cljs.core.nth.call(null,vec__11753,(1),null);var vec__11754 = new cljs.core.Keyword(null,"offset","offset",296498311).cljs$core$IFn$_invoke$arity$1(window_state);var off_x = cljs.core.nth.call(null,vec__11754,(0),null);var off_y = cljs.core.nth.call(null,vec__11754,(1),null);var vec__11755 = new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(mx - off_x),(my - off_y)], null);var tnx = cljs.core.nth.call(null,vec__11755,(0),null);var tny = cljs.core.nth.call(null,vec__11755,(1),null);var min_x = (-150);var max_x = (document.body.clientWidth - (50));var min_y = (0);var max_y = (document.body.clientHeight - (50));var new_position = new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(((min_x > tnx))?min_x:(((tnx > max_x))?max_x:((new cljs.core.Keyword(null,"else","else",-1508377146))?tnx:null))),(((min_y > tny))?min_y:(((tny > max_y))?max_y:((new cljs.core.Keyword(null,"else","else",-1508377146))?tny:null)))], null);return cljs.core.assoc.call(null,window_state,new cljs.core.Keyword(null,"position","position",-2011731912),new_position);
} else
{return window_state;
}
}));
cljs.core._add_method.call(null,growingtree_app.controllers.states.transition,new cljs.core.Keyword(null,"draggable","draggable",1676206163),(function (target,msg_type,p__11757,state){var vec__11758 = p__11757;var sub_msg_type = cljs.core.nth.call(null,vec__11758,(0),null);var map__11759 = cljs.core.nth.call(null,vec__11758,(1),null);var map__11759__$1 = ((cljs.core.seq_QMARK_.call(null,map__11759))?cljs.core.apply.call(null,cljs.core.hash_map,map__11759):map__11759);var msg_data = map__11759__$1;var name = cljs.core.get.call(null,map__11759__$1,new cljs.core.Keyword(null,"name","name",1843675177));return cljs.core.update_in.call(null,state,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"windows","windows",2068861701),name], null),((function (vec__11758,sub_msg_type,map__11759,map__11759__$1,msg_data,name){
return (function (p1__11756_SHARP_){return growingtree_app.controllers.states.window_drag_event.call(null,sub_msg_type,new cljs.core.Keyword(null,"position","position",-2011731912).cljs$core$IFn$_invoke$arity$1(msg_data),p1__11756_SHARP_);
});})(vec__11758,sub_msg_type,map__11759,map__11759__$1,msg_data,name))
);
}));
cljs.core._add_method.call(null,growingtree_app.controllers.states.transition,new cljs.core.Keyword(null,"toggle-inspector-key-pressed","toggle-inspector-key-pressed",1257821948),(function (target,msg_type,msg_data,state){return cljs.core.update_in.call(null,state,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"windows","windows",2068861701),new cljs.core.Keyword(null,"window-inspector","window-inspector",889258900),new cljs.core.Keyword(null,"open","open",-1763596448)], null),cljs.core.not);
}));
cljs.core._add_method.call(null,growingtree_app.controllers.states.transition,new cljs.core.Keyword(null,"inspector-path-updated","inspector-path-updated",-165750316),(function (target,msg_type,path,state){return cljs.core.assoc_in.call(null,state,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"settings","settings",1556144875),new cljs.core.Keyword(null,"inspector","inspector",1532863880),new cljs.core.Keyword(null,"path","path",-188191168)], null),path);
}));
cljs.core._add_method.call(null,growingtree_app.controllers.states.transition,new cljs.core.Keyword(null,"state-restored","state-restored",450621293),(function (target,msg_type,path,state){var str_data = localStorage.getItem("growingtree-app-state");if(cljs.core.seq.call(null,str_data))
{return cljs.core.assoc.call(null,cljs.reader.read_string.call(null,str_data),new cljs.core.Keyword(null,"comms","comms",460172477),new cljs.core.Keyword(null,"comms","comms",460172477).cljs$core$IFn$_invoke$arity$1(state));
} else
{return state;
}
}));
growingtree_app.controllers.states.update_navbar_selected = (function update_navbar_selected(state,last_nav_type,cur_nav_type){var last_nav_type__$1 = cljs.core.some.call(null,cljs.core.PersistentHashSet.fromArray([last_nav_type], true),growingtree_app.mock_data.nav_types);var cur_nav_type__$1 = cljs.core.some.call(null,cljs.core.PersistentHashSet.fromArray([cur_nav_type], true),growingtree_app.mock_data.nav_types);console.log(cljs.core.pr_str.call(null,"update-navbar-selected cur-nav-type ",cur_nav_type__$1," last ",last_nav_type__$1));
var G__11761 = state;var G__11761__$1 = (cljs.core.truth_(last_nav_type__$1)?cljs.core.assoc_in.call(null,G__11761,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"things","things",1255021880),last_nav_type__$1,new cljs.core.Keyword(null,"selected","selected",574897764)], null),false):G__11761);var G__11761__$2 = (cljs.core.truth_(cur_nav_type__$1)?cljs.core.assoc_in.call(null,G__11761__$1,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"things","things",1255021880),cur_nav_type__$1,new cljs.core.Keyword(null,"selected","selected",574897764)], null),true):G__11761__$1);return G__11761__$2;
});

//# sourceMappingURL=states.js.map